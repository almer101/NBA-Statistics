---
title: "NBADescriptive"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Opis podataka


```{r}

seasons.stats = read.csv("Seasons_Stats.csv", header = TRUE)
head(seasons.stats)

library(tidyverse) # sluzi za grupiranja, joinove, filtriranja

seasons.stats %>% group_by(Year) %>% summarize(PTSAvg = mean(PTS)) -> averagePoints
averagePoints
plot(averagePoints)

# plotting average points per year through all seasons
pod = seasons.stats[c('Year', 'X3PA', 'X2PA', 'G')]
pod$X3PAPerGame = pod$X3PA / pod$G
pod$X2PAPerGame = pod$X2PA / pod$G
head(pod)
complete = pod[complete.cases(pod),]
head(complete)

#x3paByYear %>% group_by(Year) %>% summarize(ThreePointAttempts = mean(X3PA)) -> threePointAttempts
complete %>% group_by(Year) %>% summarize(ThreePointAttempts = mean(X3PAPerGame)) -> threePointAttempts
complete %>% group_by(Year) %>% summarize(TwoPointAttempts = mean(X2PAPerGame)) -> twoPointAttempts

threePointAttempts
twoPointAttempts

# plotting three and two point attempts through the years
plot(threePointAttempts$Year, threePointAttempts$ThreePointAttempts, xlim=c(min(threePointAttempts$Year), max(threePointAttempts$Year)), ylim=c(min(threePointAttempts$ThreePointAttempts), max(threePointAttempts$ThreePointAttempts)), col='blue')
plot(threePointAttempts$Year, twoPointAttempts$TwoPointAttempts, col='red')

```

# 

Filozofija igre je 60-ih i 70-ih godina bila takva da je tempo igre je bio puno brzi, odnosno bilo je ukupno vise posjeda lopte.


```{r}

seasons.stats %>% group_by(Year) %>% summarize(PFAvg = mean(PF)) -> averageFouls
averageFouls
plot(averageFouls)

seasons.stats %>% group_by(Year) %>% summarize(FTAAvg = mean(FTA)) -> freeThrowAttempts
freeThrowAttempts
plot(freeThrowAttempts)


```

NBA je entertainment industrija i gledanost im je jako bitan aspekt s obzirom da gledanost nosi profit. Foulovi usporavaju igru, i u korist tome govori i novo uvedeno pravilo, da se foulovi u kontri kaznjavaju nesportskim greskama (2 bacanja i posjed lopte), sto obeshrabruje obrambene igrace da rade foulove u kontri. Namjera tog pravila je da se kontre maksimalno dopustaju s obzirom da najcesce rezultiraju atraktivnom zavrsnicom sto pogoduje gledanosti.


```{r}

plot(seasons.stats$PF, seasons.stats$PTS)
plot(seasons.stats$MP, seasons.stats$PF)

```

Vidi se lagani porast zbog korelacije izmedu 

```{r}

head(seasons.stats)
player.data = read.csv("player_data.csv")
players = read.csv('Players.csv')

head(seasons.stats)
head(player.data)
head(players)

seasons.stats %>% group_by(Player) %>% summarize(PlayerPTSAvg = mean(PTS)) -> playerPTSAverage
playerPTSAverage

player.season.data = merge(x = playerPTSAverage, y = players, by = "Player", all.y = TRUE)

head(player.season.data)

plot(player.season.data$height, player.season.data$PlayerPTSAvg)
hist(player.season.data$height)
hist(player.season.data$weight)

player.heights.complete = player.season.data$height[complete.cases(player.season.data$height)]

mean(player.heights.complete)
median(player.heights.complete)
sd(player.heights.complete)

boxplot(player.heights.complete, main='Players height boxplot', ylab='Players height [cm]')

min(player.heights.complete)
max(player.heights.complete)

```

```{r}

# grupiranje po pozicijama
head(player.data)

players.joined = inner_join(player.data, players, by=c("name" = "Player"))

players.joined %>% group_by(position) %>% summarize(averageHeight = mean(height.y)) -> averageHeightForPlayersByPosition
averageHeightForPlayersByPosition

plot(averageHeightForPlayersByPosition$position, averageHeightForPlayersByPosition$averageHeight)

```

Dobiveni su podaci kao i ocekivani, pozicije G (Guards) ne zahtijevaju da su igraci visoki, dok za pozicije F (Forward) i C (Center) se zahtijeva visina zbog uloge koje imaju u igri.

```{r}

seasons.stats$TS.

top.10.colleges = c(
  'Duke University', 
  'North Carolina State University',
  'University of Kentucky',
  'Kansas State University',
  'Michigan State University',
  'Villanova University',
  'Indiana University',
  'University of Michigan',
  'University of Louisville',
  'Syracuse University'
)
season.player.nice.data = inner_join(seasons.stats, player.data, by=c("Player" = "name"))

season.player.nice.data %>% filter(college %in% top.10.colleges) %>% group_by(college) %>% summarize(tsAverage = mean(TS.)) -> tsAverage
tsAverageData = tsAverage[complete.cases(tsAverage),]
tsAverageData
dim(tsAverageData)

plot(tsAverageData$college, tsAverageData%)

```

